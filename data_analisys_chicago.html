<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio</title>
    <script src="https://kit.fontawesome.com/da34e8120e.js" crossorigin="anonymous"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/main.css">
</head>

<body class="light-theme">
    <header class="header" id="inicio">
        <div class="contenedor">
            <h2 class="name">CÃ©sar Ruiz Flores</h2>
        </div>
        <svg xmlns="http://www.w3.org/2000/svg" class="icon hamburguer" viewBox="0 0 448 512">
            <path
                d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z" />
        </svg>
        <nav class="menu-navegacion">
            <a href="#inicio">inicio</a>
            <a href="#services">Services</a>
            <a href="#about">About me</a>
            <a href="#portfolio">portafolio</a>
            <a href="#contact">contact</a>
        </nav>

        <section class="gallery" id="forecasting">
            <div class="title">
                <h1>Forecasting</h1>
            </div>
            <div class="contenedor-objetivos">
                <div class="column">
                    <h1>Goal</h1>
                    <p>Use joins to query data from multiple tables

                        Create and query views
                        
                        Write and run stored procedures
                        
                        Use transactions
                        Use sql
                        
                    </p>
                    <h2>Create database </h2>
                    <h2>Load the dump files</h2>
                    <h2>Write and execute a SQL query to list the school names, community names and average attendance for communities with a hardship index of 98</h2>
                    <h2>familiarize the data in the tables</h2>
                    <p>hardship index is in the chicago_socioeconomic_data table
                        school names, community names are in the chicago_public_schools table
                        we need to join so the index to join in the tables so the community area number
                        is the data we need
                        SELECT * FROM `chicago_public_schools` AS CPS LEFT OUTER JOIN `chicago_socioeconomic_data` AS CS ON CPS.COMMUNITY_AREA_NUMBER = CS.COMMUNITY_AREA_NUMBER
                        now that we have the data lets retrieve the school names(NAME_OF_SCHOOL), community names(COMMUNITY_AREA_NAME) and average attendance for communities(AVERAGE_STUDENT_ATTENDANCE)
                        now lets filter by hardship index=98
                        SELECT CPS.NAME_OF_SCHOOL,CPS.COMMUNITY_AREA_NAME,CPS.AVERAGE_STUDENT_ATTENDANCE FROM `chicago_public_schools` AS CPS LEFT OUTER JOIN `chicago_socioeconomic_data` AS CS ON CPS.COMMUNITY_AREA_NUMBER = CS.COMMUNITY_AREA_NUMBER WHERE HARDSHIP_INDEX = 98;
                        lets see if the filter is ok showing the HARDSHIP_INDEX
                        SELECT CPS.NAME_OF_SCHOOL,CPS.COMMUNITY_AREA_NAME,CPS.AVERAGE_STUDENT_ATTENDANCE,CS.HARDSHIP_INDEX FROM `chicago_public_schools` AS CPS LEFT OUTER JOIN `chicago_socioeconomic_data` AS CS ON CPS.COMMUNITY_AREA_NUMBER = CS.COMMUNITY_AREA_NUMBER WHERE HARDSHIP_INDEX = 98;
                    </p>
                    <P>we can also do that with sub-queries
                        SELECT NAME_OF_SCHOOL,COMMUNITY_AREA_NAME,AVERAGE_STUDENT_ATTENDANCE FROM `chicago_public_schools` WHERE COMMUNITY_AREA_NUMBER IN (SELECT COMMUNITY_AREA_NUMBER FROM `chicago_socioeconomic_data` WHERE HARDSHIP_INDEX=98);

                    </P>
                    <h2>Write and execute a SQL query to list all crimes that took place at a school. Include case number, crime type and community name.</h2>
                    <p>

                        the tables that contain the information we want are CHICAGO_CRIME and CHICAGO_SOCIOECONOMIC_DATA
                        CASE_NUMBER, PRIMARY_TYPE, COMMUNITY_AREA_NAME
                        AREA_NUMBER is the label to do join 
                        SELECT * FROM `chicago_crime`AS CC LEFT OUTER JOIN `chicago_socioeconomic_data`AS CSD ON CC.COMMUNITY_AREA_NUMBER = CSD.COMMUNITY_AREA_NUMBER;
                        now location_description will help to locate all crimes that took place at a school
                        CC.LOCATION_DESCRIPTION = '%school%';
                        the first % say we can place any letter before school and it will be right
                        the second % say we can place any letter after school and it will be right
                        and we will use the workd LIKE to search in the LOCATION_DESCRIPTION
                        SELECT * FROM `chicago_crime`AS CC LEFT OUTER JOIN `chicago_socioeconomic_data`AS CSD ON CC.COMMUNITY_AREA_NUMBER = CSD.COMMUNITY_AREA_NUMBER WHERE CC.LOCATION_DESCRIPTION LIKE '%school%';
                        now that we have all the data we can retrieve the columns that we want
                        SELECT CC.CASE_NUMBER, CC.PRIMARY_TYPE, CSD.COMMUNITY_AREA_NAME FROM `chicago_crime`AS CC LEFT OUTER JOIN `chicago_socioeconomic_data`AS CSD ON CC.COMMUNITY_AREA_NUMBER = CSD.COMMUNITY_AREA_NUMBER WHERE CC.LOCATION_DESCRIPTION LIKE '%school%';

                    </p>
                    <h2>CREATE A VIEW </h2>


                    <p>
                        For privacy reasons, you have been asked to create a view that enables users to select just the school name and the icon fields from the CHICAGO_PUBLIC_SCHOOLS table. By providing a view, you can ensure that users cannot see the actual scores given to a school, just the icon associated with their score. You should define new names for the view columns to obscure the use of scores and icons in the original table.

                        Write and execute a SQL statement to create a view showing the columns listed    
                        in the following table, with new column names as shown in the second column.
                        Column name in CHICAGO_PUBLIC_SCHOOLS	Column name in view
                        NAME_OF_SCHOOL	School_Name
                        Safety_Icon	Safety_Rating
                        Family_Involvement_Icon	Family_Rating
                        Environment_Icon	Environment_Rating
                        Instruction_Icon	Instruction_Rating
                        Leaders_Icon	Leaders_Rating
                        Teachers_Icon	Teachers_Rating
                        Write and execute a SQL statement that returns all of the columns from the view.
                        
                        Write and execute a SQL statement that returns just the school name and leaders rating from the view.
                    </p>

                    <h2>Creating a Stored Procedure</h2>

                    <p>The icon fields are calculated based on the value in the corresponding score field. You need to make sure that when a score field is updated, the icon field is updated too. To do this, you will write a stored procedure that receives the school id and a leaders score as input parameters, calculates the icon setting and updates the fields appropriately.


                        Question 1

                        Write the structure of a query to create or replace a stored procedure called UPDATE_LEADERS_SCORE that takes a in_School_ID parameter as an integer and a in_Leader_Score parameter as an integer.

                        Take a screenshot showing the SQL query.


                        Question 2

                        Inside your stored procedure, write a SQL statement to update the Leaders_Score field in the CHICAGO_PUBLIC_SCHOOLS table for the school identified by in_School_ID to the value in the in_Leader_Score parameter.

                        Take a screenshot showing the SQL query.


                        Question 3

                        Inside your stored procedure, write a SQL IF statement to update the Leaders_Icon field in the CHICAGO_PUBLIC_SCHOOLS table for the school identified by in_School_ID using the following information.

                        Score lower limit	Score upper limit	Icon

                        80	99	Very strong

                        60	79	Strong

                        40	59	Average

                        20	39	Weak

                        0	19	Very weak
                    </p>
                    <P>DELIMITER $$
                        CREATE PROCEDURE UPDATE_ICON(IN in_Leaders_Score INT,IN in_School_ID INT)
                        BEGIN 
                        
                        UPDATE `chicago_public_schools` SET Leaders_Score = in_Leaders_Score WHERE School_ID=in_School_ID;
                        
                        IF in_Leaders_Score>= 0 AND in_Leaders_Score< 20 THEN                        
                        UPDATE `chicago_public_schools` SET Leaders_Icon = "Very Weak" WHERE School_ID=in_School_ID;
                                                                        
                        ELSEIF in_Leaders_Score> 20 AND in_Leaders_Score< 40 THEN
                                                                        
                        UPDATE `chicago_public_schools` SET Leaders_Icon = "Weak" WHERE School_ID=in_School_ID;
                                                
                                                
                        ELSEIF in_Leaders_Score> 40 AND
                        in_Leaders_Score< 60 THEN
                                                
                                                
                        UPDATE `chicago_public_schools` SET Leaders_Icon = "Average" WHERE School_ID=in_School_ID;
                                                
                                                
                        ELSEIF in_Leaders_Score> 60 AND
                        in_Leaders_Score< 80 THEN
                                                
                                                
                        UPDATE `chicago_public_schools` SET Leaders_Icon = "Strong" WHERE School_ID=in_School_ID;
                                                
                                                
                        ELSEIF in_Leaders_Score> 80 AND
                        in_Leaders_Score< 100 THEN                        
                        
                                                
                        UPDATE `chicago_public_schools` SET Leaders_Icon = "Very Strong" WHERE School_ID=in_School_ID;
                                                
                                                
                        END IF;
                        END 
                        $$
                        DELIMITER ;</P>
                    <p>BEGIN 
                        
                        
                        UPDATE `chicago_public_schools` SET Leaders_Score = in_Leaders_Score WHERE School_ID=in_School_ID;
                                                
                                                
                        IF in_Leaders_Score>= 0 AND in_Leaders_Score< 20 THEN                        
                                                
                        UPDATE `chicago_public_schools` SET Leaders_Icon = "Very Weak" WHERE School_ID=in_School_ID;
                                                                                                
                                                
                        ELSEIF in_Leaders_Score> 20 AND in_Leaders_Score< 40 THEN
                                                                                                
                                                
                        UPDATE `chicago_public_schools` SET Leaders_Icon = "Weak" WHERE School_ID=in_School_ID;
                                                                        
                                                                        
                                                
                        ELSEIF in_Leaders_Score> 40 AND
                        in_Leaders_Score< 60 THEN
                                                                        
                                                                        
                                                
                        UPDATE `chicago_public_schools` SET Leaders_Icon = "Average" WHERE School_ID=in_School_ID;
                                                                        
                                                                        
                                                
                        ELSEIF in_Leaders_Score> 60 AND
                        in_Leaders_Score< 80 THEN
                                                                        
                                                                        
                                                
                        UPDATE `chicago_public_schools` SET Leaders_Icon = "Strong" WHERE School_ID=in_School_ID;
                                                                        
                                                                        
                                                
                        ELSEIF in_Leaders_Score> 80 AND
                        in_Leaders_Score< 100 THEN                        
                                                
                                                                        
                                                
                        UPDATE `chicago_public_schools` SET Leaders_Icon = "Very Strong" WHERE School_ID=in_School_ID;
                                                                        
                                                                        
                                                
                        END IF;
                                                
                        END</p>
                        <P>CALL UPDATE_ICON(50,610038);</P>
                    <h2>Using Transactions</h2>
                    <p>You realise that if someone calls your code with a score outside of the allowed range (0-99), then the score will be updated with the invalid data and the icon will remain at its previous value. There are various ways to avoid this problem, one of which is using a transaction.

                        Question 1
                        Update your stored procedure definition. Add a generic ELSE clause to the IF statement that rolls back the current work if the score did not fit any of the preceding categories.
                        Hint 1
                        You can add an ELSE clause to the IF statement which will only run if none of the previous conditions have been met.
                        Take a screenshot showing the SQL query.
                        
                        Question 2
                        Update your stored procedure definition again. Add a statement to commit the current unit of work at the end of the procedure.
                        Hint 1
                        Remember that as soon as any code inside the IF/ELSE IF/ELSE statements completes, processing resumes after the END IF, so you can add your commit code there.
                        Take a screenshot showing the SQL query.
                        
                        Run your code to replace the stored procedure.
                        
                        Write and run one query to check that the updated stored procedure works as expected when you use a valid score of 38.
                        
                        Write and run another query to check that the updated stored procedure works as expected when you use an invalid score of 101.</p>
                </div>
                <div class="column">
                    <h1>Result</h1>
                    <p>The outcome of this exercise is a Power BI report that includes a customized line chart with a forecasting line. This enhanced visualization provides a projection of the world population over the next 10 years, adding significant predictive insight to the analysis.

                        By completing this exercise, you gain practical experience in using Power BI's forecasting capabilities to create informative and visually appealing predictive analyses. This allows for better decision-making and strategic planning based on projected data trends.</p>
                </div>
                <div class="column"><img src="img/forecasting.png" alt="an image of executive summary"
                        class="img-portfolio"></div>

            </div>





        </section>
        <section class="imagen-light">
            <i class="fa-solid fa-xmark close"></i>
            <img class="agregar-imagen" src="" alt="">
        </section>

        </main>
        <footer id="contact ">
            <div class="contenedor footer-content">
                <div class="contact-us">
                    <h1 class="brand">telefono</h1>
                </div>
                <div class="social-media">

                    <a href="https://www.linkedin.com/in/cesar-ruiz-f/" class="social-media-icon"><i
                            class="fa-brands fa-linkedin "></i></a>
                    <a href="mailto:cesar.ruiz.f@gmail.com" class="social-media-icon"><i
                            class="fa-solid fa-envelope"></i></a>


                </div>
            </div>
            <div class="line"></div>
        </footer>
        <script src="js/app.js"></script>
        <script src="js/menu.js"></script>
        <script src="js/lightbox.js"></script>
        <script src="js/lightbox2.js"></script>
</body>

</html>